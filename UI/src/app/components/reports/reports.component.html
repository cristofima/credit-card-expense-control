<div class="card">
  <br />

  <p-dropdown [(ngModel)]="year" [options]="yearOptions" (onChange)="onChangeYear()"></p-dropdown>

  <br />

  <p-table [value]="report" [tableStyle]="{'min-width': '70rem'}">
    <ng-template pTemplate="caption">AÃ±o {{year}}</ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th>Tarjeta</th>
        <th>Enero</th>
        <th>Febrero</th>
        <th>Marzo</th>
        <th>Abril</th>
        <th>Mayo</th>
        <th>Junio</th>
        <th>Julio</th>
        <th>Agosto</th>
        <th>Septiembre</th>
        <th>Octubre</th>
        <th>Noviembre</th>
        <th>Diciembre</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-report>
      <tr>
        <td>{{report.creditCardName}}</td>
        <td>{{report.january | currency}}</td>
        <td>{{report.february | currency}}</td>
        <td>{{report.march | currency}}</td>
        <td>{{report.april | currency}}</td>
        <td>{{report.may | currency}}</td>
        <td>{{report.june | currency}}</td>
        <td>{{report.july | currency}}</td>
        <td>{{report.august | currency}}</td>
        <td>{{report.september | currency}}</td>
        <td>{{report.october | currency}}</td>
        <td>{{report.november | currency}}</td>
        <td>{{report.december | currency}}</td>
      </tr>
    </ng-template>
    <ng-template pTemplate="footer">
      <tr>
        <td>TOTAL</td>
        <td>{{summary.january | currency}}</td>
        <td>{{summary.february | currency}}</td>
        <td>{{summary.march | currency}}</td>
        <td>{{summary.april | currency}}</td>
        <td>{{summary.may | currency}}</td>
        <td>{{summary.june | currency}}</td>
        <td>{{summary.july | currency}}</td>
        <td>{{summary.august | currency}}</td>
        <td>{{summary.september | currency}}</td>
        <td>{{summary.october | currency}}</td>
        <td>{{summary.november | currency}}</td>
        <td>{{summary.december | currency}}</td>
      </tr>
    </ng-template>
  </p-table>

  <br />

  <p-dropdown [(ngModel)]="month" [options]="monthOptions" (onChange)="onChangeMonth()"></p-dropdown>

  <br />

  <p-table [value]="transactionsReport" sortField="creditCard.name" sortMode="single" dataKey="creditCard.id"
    rowGroupMode="subheader" groupRowsBy="creditCard.id" [tableStyle]="{'min-width': '70rem'}">
    <ng-template pTemplate="caption">Mes {{stringMonth}}</ng-template>
    <ng-template pTemplate="header">
      <tr>
        <th>Tienda</th>
        <th>Monto Total</th>
        <th>Cuota</th>
        <th>Fecha de Compra</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="groupheader" let-transaction let-rowIndex="rowIndex" let-expanded="expanded">
      <tr>
        <td colspan="2">
          <button type="button" pButton pRipple [pRowToggler]="transaction"
            class="p-button-text p-button-rounded p-button-plain mr-2"
            [icon]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></button>
          <span class="font-bold ml-2">{{transaction.creditCard.name}}</span>
        </td>
        <td style="text-align: right;"><b>{{caculateTotalByCreditCard(transaction.creditCard.id) | currency}}</b></td>
        <td></td>
      </tr>
    </ng-template>
    <ng-template pTemplate="rowexpansion" let-transaction>
      <tr>
        <td>
          {{transaction.description}}
        </td>
        <td style="text-align: right;">
          {{transaction.amount | currency}}
        </td>
        <td style="text-align: right;">
          {{transaction.amount / transaction.quotas | currency}}
        </td>
        <td>
          {{transaction.date | date}}
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>